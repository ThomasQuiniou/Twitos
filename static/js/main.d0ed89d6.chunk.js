(this.webpackJsonptwitter=this.webpackJsonptwitter||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(12),r=n.n(i),o=(n(18),n(6)),c=n(2),u=n(3),l=n(5),m=n(4),d=(n(19),n(0)),h=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(d.jsx)("header",{children:Object(d.jsx)("div",{className:"container",children:Object(d.jsx)("h1",{children:"Twitter pour \xe9pileptique"})})})}}]),n}(s.a.Component),j=n(11),p=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"list",value:function(e,t){var n=new XMLHttpRequest;n.open("GET","http://touiteur.cefim-formation.org/list?ts="+encodeURIComponent(e),!0),n.addEventListener("readystatechange",(function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var e=JSON.parse(n.responseText);t(e)}})),n.send()}},{key:"post",value:function(e,t,n,a){var s=new XMLHttpRequest;s.open("POST","http://touiteur.cefim-formation.org/send",!0),s.addEventListener("readystatechange",(function(){if(s.readyState===XMLHttpRequest.DONE&&200===s.status){var e=JSON.parse(s.responseText);e.hasOwnProperty("success")?n(e):e.hasOwnProperty("error")?a(e.error):a("Erreur inconnu")}})),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send("name="+encodeURIComponent(e)+"&message="+t)}},{key:"getTrending",value:function(e){var t=new XMLHttpRequest;t.open("GET","http://touiteur.cefim-formation.org/trending",!0),t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.DONE&&200===t.status){var n=JSON.parse(t.responseText);e(n)}})),t.send()}},{key:"getOnetouit",value:function(e){return fetch("http://touiteur.cefim-formation.org/get?id="+encodeURIComponent(e)).then((function(e){return e.json()}))}},{key:"getComments",value:function(e){return fetch("http://touiteur.cefim-formation.org/comments/list?message_id="+encodeURIComponent(e)).then((function(e){return e.json()}))}},{key:"like",value:function(e){var t=new XMLHttpRequest;t.open("PUT","http://touiteur.cefim-formation.org/likes/send",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("message_id="+encodeURIComponent(e))}},{key:"dislike",value:function(e){var t=new XMLHttpRequest;t.open("DELETE","http://touiteur.cefim-formation.org/likes/remove",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("message_id="+encodeURIComponent(e))}},{key:"postComment",value:function(e,t,n,a,s){var i=new XMLHttpRequest;i.open("POST","http://touiteur.cefim-formation.org/comments/send",!0),i.addEventListener("readystatechange",(function(){if(i.readyState===XMLHttpRequest.DONE&&200===i.status){var e=JSON.parse(i.responseText);e.hasOwnProperty("success")?a(e):e.hasOwnProperty("error")?s(e.error):s("Erreur inconnu")}})),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send("name="+encodeURIComponent(t)+"&message_id="+e+"&comment="+n)}}]),e}(),b=(n(21),function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).setStateAffichageModale=function(t){e.props.changeStateHandler(t)},e.likeTouit=function(e){console.log(e,"the id of twit liker"),p.like(e)},e.dislikeTouit=function(e){p.dislike(e)},e}return Object(u.a)(n,[{key:"getRandomColor",value:function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.name,a=e.message;return Object(d.jsxs)("div",{style:{backgroundColor:this.getRandomColor()},className:"touit",children:[Object(d.jsx)("p",{className:"touit-name",children:n}),Object(d.jsx)("p",{className:"touit-message",children:a}),Object(d.jsx)("button",{onClick:this.setStateAffichageModale.bind(this,t),children:"go"}),Object(d.jsx)("button",{onClick:this.likeTouit.bind(this,t),children:"Like"}),Object(d.jsx)("button",{onClick:this.dislikeTouit.bind(this,t),children:"Dislike"})]})}}]),n}(s.a.Component)),f=(n(22),function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).changeState=function(e){a.props.changeStateHandler(e)},a.state={result:[]},a.lastTimestamp=0,a.intervalId=!1,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.intervalId=setInterval((function(){p.list(e.lastTimestamp,(function(t){t.messages.length>0&&e.setState({result:[].concat(Object(j.a)(e.state.result),Object(j.a)(t.messages))}),e.lastTimestamp=t.ts}))}),1e3)}},{key:"componentWillUnmount",value:function(){!1!==this.intervalId&&clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this;return Object(d.jsx)("section",{className:"touit-container",children:Object(d.jsx)("div",{className:"container",children:this.state.result.sort((function(e,t){return t.ts-e.ts})).map((function(t){return Object(a.createElement)(b,Object(o.a)(Object(o.a)({changeStateHandler:e.changeState},t),{},{key:t.id}))}))})})}}]),n}(s.a.Component)),O=n(7),v=n(13),g=(n(23),function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={words:[]},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;p.getTrending((function(t){e.setState({words:Object.entries(t).map((function(e){var t=Object(v.a)(e,2);return{key:t[0],value:t[1]}})).sort((function(e,t){return t.value-e.value}))})}))}},{key:"render",value:function(){return Object(d.jsx)("section",{className:"trending",children:this.state.words.map((function(e){return Object(d.jsx)("p",{children:e.key},e.key)}))})}}]),n}(s.a.Component)),x=(n(24),function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).inputChange=function(e){a.setState(Object(O.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){p.post(a.state.name,a.state.message,(function(){a.setState({name:"",message:""}),alert("Votre message est bien envoy\xe9")}),(function(e){alert("Une erreur est survenue : "+e+" !")})),e.preventDefault()},a.state={name:"",message:""},a}return Object(u.a)(n,[{key:"render",value:function(){return Object(d.jsx)("section",{className:"formulaire",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(d.jsx)("label",{children:"Nom :"}),Object(d.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:this.inputChange}),Object(d.jsx)("label",{children:"Votre touit:"}),Object(d.jsx)("textarea",{name:"message",value:this.state.message,onChange:this.inputChange}),Object(d.jsx)("input",{className:"button-submit",type:"submit",value:"Envoyer"})]}),Object(d.jsx)(g,{})]})})}}]),n}(s.a.Component)),y=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.comment;return Object(d.jsx)("section",{className:"commentaires",children:Object(d.jsxs)("div",{children:[t," : ",n," "]})})}}]),n}(s.a.Component),C=(n(25),function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).inputChange=function(e){a.setState(Object(O.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){p.postComment(a.props.id,a.state.name,a.state.comment,(function(){a.setState({message_id:"",name:"",comment:""}),p.getComments(a.props.id).then((function(e){return a.setState({resultComments:e.comments})})),alert("Votre message est bien envoy\xe9")}),(function(e){alert("Une erreur est survenue : "+e+" !")})),e.preventDefault()},a.closeModale=function(){a.props.changeStateHandler()},a.state={resultComments:[],message_id:"",name:"",comment:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;p.getComments(this.props.id).then((function(t){return e.setState({resultComments:t.comments})}))}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.name,a=e.likes;return Object(d.jsx)("section",{className:"modale-background",children:Object(d.jsxs)("div",{className:"modale",children:[Object(d.jsxs)("p",{children:["Auteur : ",n]}),Object(d.jsxs)("p",{children:["Message : ",t]}),Object(d.jsxs)("p",{children:[a," likes"]}),this.state.resultComments.length>0&&Object(d.jsx)("p",{children:"Commentaires : "}),this.state.resultComments.map((function(e,t){return Object(d.jsx)(y,Object(o.a)({},e),t)})),Object(d.jsx)("button",{onClick:this.closeModale,children:"X"}),Object(d.jsx)("section",{className:"formulaire-comments",children:Object(d.jsx)("div",{className:"container-comments",children:Object(d.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(d.jsx)("label",{children:"Nom :"}),Object(d.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:this.inputChange}),Object(d.jsx)("label",{children:"Votre touit:"}),Object(d.jsx)("textarea",{name:"comment",value:this.state.comment,onChange:this.inputChange}),Object(d.jsx)("input",{className:"button-submit",type:"submit",value:"Envoyer"})]})})})]})})}}]),n}(s.a.Component)),k=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).changeStateModale=function(e){p.getOnetouit(e).then((function(e){return a.modale=e.data})).finally((function(){a.setState({modaleIsVisible:!a.state.modaleIsVisible})}))},a.state={modaleIsVisible:!1},a}return Object(u.a)(n,[{key:"render",value:function(){return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(h,{}),this.state.modaleIsVisible&&Object(d.jsx)(C,Object(o.a)({changeStateHandler:this.changeStateModale},this.modale)),Object(d.jsx)(x,{}),Object(d.jsx)(f,{changeStateHandler:this.changeStateModale})]})}}]),n}(s.a.Component),S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),i(e),r(e)}))};r.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(k,{})}),document.getElementById("root")),S()}},[[26,1,2]]]);
//# sourceMappingURL=main.d0ed89d6.chunk.js.map